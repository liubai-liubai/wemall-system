#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ” å¼€å§‹æ‰§è¡Œä»£ç æäº¤å‰æ£€æŸ¥..."

# 1. æ‰§è¡Œä»£ç æ ¼å¼åŒ–æ£€æŸ¥
echo "ğŸ“ æ‰§è¡ŒPrettieræ ¼å¼åŒ–æ£€æŸ¥..."
npm run prettier:check
if [ $? -ne 0 ]; then
  echo "âŒ Prettieræ ¼å¼åŒ–æ£€æŸ¥å¤±è´¥ï¼Œè¯·è¿è¡Œ npm run prettier:fix ä¿®å¤æ ¼å¼é—®é¢˜"
  exit 1
fi

# 2. æ‰§è¡ŒESLintæ£€æŸ¥
echo "ğŸ”§ æ‰§è¡ŒESLintä»£ç è´¨é‡æ£€æŸ¥..."
npm run lint
if [ $? -ne 0 ]; then
  echo "âŒ ESLintæ£€æŸ¥å¤±è´¥ï¼Œè¯·ä¿®å¤ä»£ç è´¨é‡é—®é¢˜"
  exit 1
fi

# 3. æ‰§è¡ŒTypeScriptç±»å‹æ£€æŸ¥
echo "ğŸ” æ‰§è¡ŒTypeScriptç±»å‹æ£€æŸ¥..."
npm run type-check
if [ $? -ne 0 ]; then
  echo "âŒ TypeScriptç±»å‹æ£€æŸ¥å¤±è´¥ï¼Œè¯·ä¿®å¤ç±»å‹é”™è¯¯"
  exit 1
fi

# 4. æ‰§è¡Œå•å…ƒæµ‹è¯•
echo "ğŸ§ª æ‰§è¡Œå•å…ƒæµ‹è¯•..."
npm run test:unit
if [ $? -ne 0 ]; then
  echo "âŒ å•å…ƒæµ‹è¯•å¤±è´¥ï¼Œè¯·ä¿®å¤æµ‹è¯•é—®é¢˜"
  exit 1
fi

# 5. æ£€æŸ¥commitä¿¡æ¯æ ¼å¼
echo "ğŸ“‹ æ£€æŸ¥commitä¿¡æ¯æ ¼å¼..."
npm run commitlint
if [ $? -ne 0 ]; then
  echo "âŒ commitä¿¡æ¯æ ¼å¼ä¸æ­£ç¡®ï¼Œè¯·éµå¾ªçº¦å®šå¼æäº¤è§„èŒƒ"
  echo "æ ¼å¼: type(scope): description"
  echo "ä¾‹å¦‚: feat(user): æ·»åŠ ç”¨æˆ·ç™»å½•åŠŸèƒ½"
  exit 1
fi

echo "âœ… æ‰€æœ‰æ£€æŸ¥é€šè¿‡ï¼Œå…è®¸æäº¤ä»£ç " 